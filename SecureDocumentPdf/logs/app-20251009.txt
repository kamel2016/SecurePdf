[2025-10-09 21:40:21 INF] ========================================
[2025-10-09 21:40:21 INF] Application PDF Security d√©marr√©e
[2025-10-09 21:40:21 INF] ========================================
[2025-10-09 21:42:54 INF] ========================================
[2025-10-09 21:42:54 INF] Application PDF Security d√©marr√©e
[2025-10-09 21:42:54 INF] ========================================
[2025-10-09 21:46:02 INF] ========================================
[2025-10-09 21:46:02 INF] Application PDF Security d√©marr√©e
[2025-10-09 21:46:02 INF] ========================================
[2025-10-09 21:46:03 INF] Mode : Development
[2025-10-09 21:46:03 INF] Dossiers cr√©√©s avec succ√®s
[2025-10-09 21:46:03 INF]   - Uploads : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\uploads
[2025-10-09 21:46:03 INF]   - Secured : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\secured
[2025-10-09 21:46:03 INF]   - Previews : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\secured\previews
[2025-10-09 21:46:03 INF] ========================================
[2025-10-09 21:46:03 INF] Application pr√™te !
[2025-10-09 21:46:03 INF] URL : https://localhost:7001
[2025-10-09 21:46:03 INF] Environment : Development
[2025-10-09 21:46:03 INF] ========================================
[2025-10-09 21:46:09 INF] üìÑ Page Index charg√©e - Support multi-formats activ√©
[2025-10-09 21:46:44 INF] üì§ Soumission formulaire - Utilisateur: Test
[2025-10-09 21:46:44 WRN] ‚ö†Ô∏è Validation mod√®le √©chou√©e
[2025-10-09 21:48:23 INF] ========================================
[2025-10-09 21:48:23 INF] Application PDF Security d√©marr√©e
[2025-10-09 21:48:23 INF] ========================================
[2025-10-09 21:48:23 INF] Mode : Development
[2025-10-09 21:48:23 INF] Dossiers cr√©√©s avec succ√®s
[2025-10-09 21:48:23 INF]   - Uploads : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\uploads
[2025-10-09 21:48:23 INF]   - Secured : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\secured
[2025-10-09 21:48:23 INF]   - Previews : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\secured\previews
[2025-10-09 21:48:23 INF] ========================================
[2025-10-09 21:48:23 INF] Application pr√™te !
[2025-10-09 21:48:23 INF] URL : https://localhost:7001
[2025-10-09 21:48:23 INF] Environment : Development
[2025-10-09 21:48:23 INF] ========================================
[2025-10-09 21:48:26 INF] üìÑ Page Index charg√©e - Support multi-formats activ√©
[2025-10-09 21:48:47 INF] üì§ Soumission formulaire - Utilisateur: Test
[2025-10-09 21:48:47 WRN] ‚ö†Ô∏è Validation mod√®le √©chou√©e
[2025-10-09 21:50:02 INF] ========================================
[2025-10-09 21:50:02 INF] Application PDF Security d√©marr√©e
[2025-10-09 21:50:02 INF] ========================================
[2025-10-09 21:50:03 INF] Mode : Development
[2025-10-09 21:50:03 INF] Dossiers cr√©√©s avec succ√®s
[2025-10-09 21:50:03 INF]   - Uploads : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\uploads
[2025-10-09 21:50:03 INF]   - Secured : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\secured
[2025-10-09 21:50:03 INF]   - Previews : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\secured\previews
[2025-10-09 21:50:03 INF] ========================================
[2025-10-09 21:50:03 INF] Application pr√™te !
[2025-10-09 21:50:03 INF] URL : https://localhost:7001
[2025-10-09 21:50:03 INF] Environment : Development
[2025-10-09 21:50:03 INF] ========================================
[2025-10-09 21:50:06 INF] üìÑ Page Index charg√©e - Support multi-formats activ√©
[2025-10-09 21:50:42 INF] üì§ Soumission formulaire - Utilisateur: Test
[2025-10-09 21:50:42 WRN] ‚ö†Ô∏è Validation mod√®le √©chou√©e
[2025-10-09 21:50:58 INF] üì§ Soumission formulaire - Utilisateur: Test
[2025-10-09 21:51:32 INF] üìã Type d√©tect√©: Image
[2025-10-09 21:51:32 INF] üîÑ D√©but traitement - Type: Image, Taille: 1267425 bytes
[2025-10-09 21:51:32 INF] üîÑ Conversion vers PDF n√©cessaire...
[2025-10-09 21:51:35 INF] üîÑ Conversion .png ‚Üí PDF
[2025-10-09 21:51:36 ERR] ‚ùå √âchec conversion PDF
[2025-10-09 21:52:37 INF] üìã Type d√©tect√©: Image
[2025-10-09 21:52:43 INF] üîÑ D√©but traitement - Type: Image, Taille: 1764136 bytes
[2025-10-09 21:52:53 INF] üîÑ Conversion vers PDF n√©cessaire...
[2025-10-09 21:52:56 INF] üîÑ Conversion .png ‚Üí PDF
[2025-10-09 21:56:37 INF] ========================================
[2025-10-09 21:56:37 INF] Application PDF Security d√©marr√©e
[2025-10-09 21:56:37 INF] ========================================
[2025-10-09 21:56:38 INF] Mode : Development
[2025-10-09 21:56:38 INF] Dossiers cr√©√©s avec succ√®s
[2025-10-09 21:56:38 INF]   - Uploads : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\uploads
[2025-10-09 21:56:38 INF]   - Secured : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\secured
[2025-10-09 21:56:38 INF]   - Previews : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\secured\previews
[2025-10-09 21:56:38 INF] ========================================
[2025-10-09 21:56:38 INF] Application pr√™te !
[2025-10-09 21:56:38 INF] URL : https://localhost:7001
[2025-10-09 21:56:38 INF] Environment : Development
[2025-10-09 21:56:38 INF] ========================================
[2025-10-09 21:56:41 INF] üìÑ Page Index charg√©e - Support multi-formats activ√©
[2025-10-09 21:57:22 INF] üì§ Soumission formulaire - Utilisateur: Test
[2025-10-09 21:57:32 INF] üìã Type d√©tect√©: Image
[2025-10-09 21:57:32 INF] üîÑ D√©but traitement - Type: Image, Taille: 489 bytes
[2025-10-09 21:57:32 INF] üîÑ Conversion vers PDF n√©cessaire...
[2025-10-09 21:57:34 INF] üîÑ Conversion .png ‚Üí PDF
[2025-10-09 21:57:34 ERR] ‚ùå √âchec conversion PDF
[2025-10-09 21:57:57 INF] ========================================
[2025-10-09 21:57:57 INF] Application PDF Security d√©marr√©e
[2025-10-09 21:57:57 INF] ========================================
[2025-10-09 21:57:58 INF] Mode : Development
[2025-10-09 21:57:58 INF] Dossiers cr√©√©s avec succ√®s
[2025-10-09 21:57:58 INF]   - Uploads : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\uploads
[2025-10-09 21:57:58 INF]   - Secured : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\secured
[2025-10-09 21:57:58 INF]   - Previews : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\secured\previews
[2025-10-09 21:57:58 INF] ========================================
[2025-10-09 21:57:58 INF] Application pr√™te !
[2025-10-09 21:57:58 INF] URL : https://localhost:7001
[2025-10-09 21:57:58 INF] Environment : Development
[2025-10-09 21:57:58 INF] ========================================
[2025-10-09 21:58:00 INF] üìÑ Page Index charg√©e - Support multi-formats activ√©
[2025-10-09 21:58:34 INF] ========================================
[2025-10-09 21:58:34 INF] Application PDF Security d√©marr√©e
[2025-10-09 21:58:34 INF] ========================================
[2025-10-09 21:58:35 INF] Mode : Development
[2025-10-09 21:58:35 INF] Dossiers cr√©√©s avec succ√®s
[2025-10-09 21:58:35 INF]   - Uploads : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\uploads
[2025-10-09 21:58:35 INF]   - Secured : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\secured
[2025-10-09 21:58:35 INF]   - Previews : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\secured\previews
[2025-10-09 21:58:35 INF] ========================================
[2025-10-09 21:58:35 INF] Application pr√™te !
[2025-10-09 21:58:35 INF] URL : https://localhost:7001
[2025-10-09 21:58:35 INF] Environment : Development
[2025-10-09 21:58:35 INF] ========================================
[2025-10-09 21:58:39 INF] üìÑ Page Index charg√©e - Support multi-formats activ√©
[2025-10-09 21:59:01 INF] üì§ Soumission formulaire - Utilisateur: Test
[2025-10-09 21:59:01 INF] üìã Type d√©tect√©: Image
[2025-10-09 21:59:01 INF] üîÑ D√©but traitement - Type: Image, Taille: 1267425 bytes
[2025-10-09 21:59:01 INF] üîÑ Conversion vers PDF n√©cessaire...
[2025-10-09 21:59:09 INF] üîÑ Conversion .png ‚Üí PDF
[2025-10-09 21:59:25 INF] ‚úÖ Conversion PDF r√©ussie: ChatGPT Image 1 oct. 2025, 22_04_35.pdf
[2025-10-09 21:59:29 INF] üîí Lancement s√©curisation maximale...
[2025-10-09 21:59:30 INF] üîê [v3.0] D√©but du traitement PDF ULTRA-S√âCURIS√â pour Test: ChatGPT Image 1 oct. 2025, 22_04_35.pdf
[2025-10-09 21:59:30 INF] üßπ Nettoyage des m√©tadonn√©es: 6fe0ab15-f68f-4be4-b540-4a7fae380d57_ChatGPT Image 1 oct. 2025, 22_04_35.pdf
[2025-10-09 21:59:30 INF] ‚ú® M√©tadonn√©es nettoy√©es avec succ√®s: 6fe0ab15-f68f-4be4-b540-4a7fae380d57_ChatGPT Image 1 oct. 2025, 22_04_35_cleaned.pdf
[2025-10-09 21:59:30 INF] üîç Ajout du watermark invisible et empreinte
[2025-10-09 21:59:30 INF] ‚úÖ Watermark invisible ajout√©
[2025-10-09 21:59:30 INF] üî¢ G√©n√©ration des hash par page
[2025-10-09 21:59:30 ERR] ‚ùå Erreur g√©n√©ration hash pages
System.InvalidOperationException: A PDF document must be opened with PdfDocumentOpenMode.Import to import pages from it.
   at PdfSharp.Pdf.PdfPages.ImportExternalPage(PdfPage importPage)
   at PdfSharp.Pdf.PdfPages.Insert(Int32 index, PdfPage page)
   at PdfSharp.Pdf.PdfPages.Add(PdfPage page)
   at PdfSharp.Pdf.PdfDocument.AddPage(PdfPage page)
   at SecureDocumentPdf.Services.PdfSecurityService.GenerateAndSavePageHashesAsync(String pdfPath, String documentId) in C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\Services\PdfSecurityService.cs:line 1420
[2025-10-09 21:59:30 INF] üåç Ajout g√©olocalisation
[2025-10-09 21:59:30 INF] ‚úÖ G√©olocalisation ajout√©e
[2025-10-09 21:59:30 INF] ‚è∞ Configuration expiration: 3 jours
[2025-10-09 21:59:30 INF] ‚úÖ Expiration configur√©e
[2025-10-09 21:59:30 INF] üåê Enregistrement IP: 127.0.0.1
[2025-10-09 21:59:30 INF] ‚úÖ IP enregistr√©e
[2025-10-09 21:59:30 INF] üìÑ Application filigrane dynamique
[2025-10-09 21:59:30 ERR] ‚ùå Erreur filigrane dynamique
System.InvalidOperationException: No appropriate font found for family name 'Arial'. Implement IFontResolver and assign to 'GlobalFontSettings.FontResolver' to use fonts. See https://docs.pdfsharp.net/link/font-resolving.html
   at PdfSharp.Drawing.XGlyphTypeface.GetOrCreateFrom(String familyName, FontResolvingOptions fontResolvingOptions)
   at PdfSharp.Drawing.XFont.Initialize()
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style, XPdfFontOptions pdfOptions)
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style)
   at SecureDocumentPdf.Services.PdfSecurityService.ApplyDynamicPageWatermarksAsync(String inputPath, String userName, String documentId) in C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\Services\PdfSecurityService.cs:line 1570
[2025-10-09 21:59:30 INF] üì∏ Ajout protection capture √©cran
[2025-10-09 21:59:30 ERR] ‚ùå Erreur protection √©cran
System.InvalidOperationException: No appropriate font found for family name 'Arial'. Implement IFontResolver and assign to 'GlobalFontSettings.FontResolver' to use fonts. See https://docs.pdfsharp.net/link/font-resolving.html
   at PdfSharp.Drawing.XGlyphTypeface.GetOrCreateFrom(String familyName, FontResolvingOptions fontResolvingOptions)
   at PdfSharp.Drawing.XFont.Initialize()
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style, XPdfFontOptions pdfOptions)
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style)
   at SecureDocumentPdf.Services.PdfSecurityService.AddScreenCaptureProtectionAsync(String inputPath, String documentId) in C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\Services\PdfSecurityService.cs:line 1617
[2025-10-09 21:59:30 INF] üè∑Ô∏è Application du watermark de s√©curit√©: 6fe0ab15-f68f-4be4-b540-4a7fae380d57_ChatGPT Image 1 oct. 2025, 22_04_35_cleaned_invisible.pdf
[2025-10-09 21:59:31 ERR] ‚ùå Erreur lors de l'application du watermark: C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\uploads\6fe0ab15-f68f-4be4-b540-4a7fae380d57_ChatGPT Image 1 oct. 2025, 22_04_35_cleaned_invisible.pdf
System.InvalidOperationException: No appropriate font found for family name 'Arial'. Implement IFontResolver and assign to 'GlobalFontSettings.FontResolver' to use fonts. See https://docs.pdfsharp.net/link/font-resolving.html
   at PdfSharp.Drawing.XGlyphTypeface.GetOrCreateFrom(String familyName, FontResolvingOptions fontResolvingOptions)
   at PdfSharp.Drawing.XFont.Initialize()
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style, XPdfFontOptions pdfOptions)
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style)
   at SecureDocumentPdf.Services.PdfSecurityService.ApplySecurityWatermarkAsync(String inputPath, String userName) in C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\Services\PdfSecurityService.cs:line 230
[2025-10-09 21:59:31 INF] üñ®Ô∏è Ajout watermark impression
[2025-10-09 21:59:31 ERR] ‚ùå Erreur watermark impression
System.InvalidOperationException: No appropriate font found for family name 'Arial'. Implement IFontResolver and assign to 'GlobalFontSettings.FontResolver' to use fonts. See https://docs.pdfsharp.net/link/font-resolving.html
   at PdfSharp.Drawing.XGlyphTypeface.GetOrCreateFrom(String familyName, FontResolvingOptions fontResolvingOptions)
   at PdfSharp.Drawing.XFont.Initialize()
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style, XPdfFontOptions pdfOptions)
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style)
   at SecureDocumentPdf.Services.PdfSecurityService.AddPrintOnlyWatermarkAsync(String inputPath, String userName) in C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\Services\PdfSecurityService.cs:line 1662
[2025-10-09 21:59:31 INF] üìú Application de la signature num√©rique PAdES: 6fe0ab15-f68f-4be4-b540-4a7fae380d57_ChatGPT Image 1 oct. 2025, 22_04_35_cleaned_invisible.pdf
[2025-10-09 21:59:33 INF] üîê Signature num√©rique PAdES simul√©e appliqu√©e: 6fe0ab15-f68f-4be4-b540-4a7fae380d57_ChatGPT Image 1 oct. 2025, 22_04_35_cleaned_invisible_signed.pdf
[2025-10-09 21:59:33 INF] üìã Certificat g√©n√©r√© - Subject: CN=Test,O=PDF Security User,C=FR
[2025-10-09 21:59:33 INF] üîí Application de la protection par chiffrement: 6fe0ab15-f68f-4be4-b540-4a7fae380d57_ChatGPT Image 1 oct. 2025, 22_04_35_cleaned_invisible_signed.pdf
[2025-10-09 21:59:33 INF] üîê PDF prot√©g√© par chiffrement 128-bit. Mot de passe: PDF_***S2C
[2025-10-09 21:59:33 INF] üîë Mot de passe sauvegard√© de mani√®re s√©curis√©e: PASSWORD_6fe0ab15-f68f-4be4-b540-4a7fae380d57_ChatGPT Image 1 oct. 2025, 22_04_35_cleaned_invisible_signed_protected.json
[2025-10-09 21:59:34 INF] ‚úÖ PDF prot√©g√© valid√© - Lecture OK, modification bloqu√©e
[2025-10-09 21:59:34 INF] ‚úÖ Protection valid√©e - PDF verrouill√© avec succ√®s
[2025-10-09 21:59:34 INF] ‚è∞ Horodatage RFC3161 g√©n√©r√©: RFC3161-2025-10-09T19:59:34.103Z-NONCE:c738f42512ac4ddd-MOCK
[2025-10-09 21:59:35 INF] üì± G√©n√©ration QR Code
[2025-10-09 21:59:35 INF] ‚úÖ QR Code g√©n√©r√©
[2025-10-09 21:59:35 INF] üñºÔ∏è G√©n√©ration pr√©visualisations
[2025-10-09 21:59:39 INF] üì∏ Pr√©visualisation g√©n√©r√©e
[2025-10-09 21:59:39 INF] üìã G√©n√©ration journal d'audit
[2025-10-09 21:59:39 INF] ‚úÖ Journal d'audit g√©n√©r√©
[2025-10-09 21:59:39 INF] üìã G√©n√©ration certificat de preuve enrichi
[2025-10-09 21:59:39 INF] ‚è∞ Horodatage RFC3161 g√©n√©r√©: RFC3161-2025-10-09T19:59:39.398Z-NONCE:1a6ad3b4ccd248ff-MOCK
[2025-10-09 21:59:39 INF] ‚úÖ Certificat de preuve enrichi g√©n√©r√©
[2025-10-09 21:59:39 INF] üéâ Traitement PDF ULTRA-S√âCURIS√â termin√© avec succ√®s pour Test en 9.37s
[2025-10-09 21:59:42 INF] ‚úÖ Traitement r√©ussi - PDF s√©curis√©: /secured/SECURED_20251009_215939_ChatGPT Image 1 oct. 2025, 22_04_35.pdf, Dur√©e: 9.3705379s
[2025-10-09 22:02:31 INF] üì§ Soumission formulaire - Utilisateur: Test
[2025-10-09 22:02:31 INF] üìã Type d√©tect√©: Tableur Excel
[2025-10-09 22:02:31 INF] üîÑ D√©but traitement - Type: Tableur Excel, Taille: 9784 bytes
[2025-10-09 22:02:31 INF] üîÑ Conversion vers PDF n√©cessaire...
[2025-10-09 22:02:35 INF] üîÑ Conversion .xlsx ‚Üí PDF
[2025-10-09 22:02:38 ERR] ‚ùå √âchec conversion PDF
[2025-10-09 22:02:57 INF] üì§ Soumission formulaire - Utilisateur: Test
[2025-10-09 22:02:57 INF] üìã Type d√©tect√©: Tableur OpenDocument
[2025-10-09 22:02:57 INF] üîÑ D√©but traitement - Type: Tableur OpenDocument, Taille: 6338 bytes
[2025-10-09 22:02:57 INF] üîÑ Conversion vers PDF n√©cessaire...
[2025-10-09 22:02:58 INF] üîÑ Conversion .ods ‚Üí PDF
[2025-10-09 22:02:58 ERR] ‚ùå √âchec conversion PDF
[2025-10-09 22:03:18 INF] üì§ Soumission formulaire - Utilisateur: Test
[2025-10-09 22:03:18 INF] üìã Type d√©tect√©: Document Word
[2025-10-09 22:03:18 INF] üîÑ D√©but traitement - Type: Document Word, Taille: 36981 bytes
[2025-10-09 22:03:18 INF] üîÑ Conversion vers PDF n√©cessaire...
[2025-10-09 22:03:19 INF] üîÑ Conversion .docx ‚Üí PDF
[2025-10-09 22:03:21 INF] ‚úÖ Conversion PDF r√©ussie: Menu_Salades_Plats.pdf
[2025-10-09 22:03:21 INF] üîí Lancement s√©curisation maximale...
[2025-10-09 22:03:21 INF] üîê [v3.0] D√©but du traitement PDF ULTRA-S√âCURIS√â pour Test: Menu_Salades_Plats.pdf
[2025-10-09 22:03:21 INF] üßπ Nettoyage des m√©tadonn√©es: 921ca989-016f-4f7f-a91e-7cde29e0f6a2_Menu_Salades_Plats.pdf
[2025-10-09 22:03:21 INF] ‚ú® M√©tadonn√©es nettoy√©es avec succ√®s: 921ca989-016f-4f7f-a91e-7cde29e0f6a2_Menu_Salades_Plats_cleaned.pdf
[2025-10-09 22:03:22 INF] üîç Ajout du watermark invisible et empreinte
[2025-10-09 22:03:22 INF] ‚úÖ Watermark invisible ajout√©
[2025-10-09 22:03:22 INF] üî¢ G√©n√©ration des hash par page
[2025-10-09 22:03:22 ERR] ‚ùå Erreur g√©n√©ration hash pages
System.InvalidOperationException: A PDF document must be opened with PdfDocumentOpenMode.Import to import pages from it.
   at PdfSharp.Pdf.PdfPages.ImportExternalPage(PdfPage importPage)
   at PdfSharp.Pdf.PdfPages.Insert(Int32 index, PdfPage page)
   at PdfSharp.Pdf.PdfPages.Add(PdfPage page)
   at PdfSharp.Pdf.PdfDocument.AddPage(PdfPage page)
   at SecureDocumentPdf.Services.PdfSecurityService.GenerateAndSavePageHashesAsync(String pdfPath, String documentId) in C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\Services\PdfSecurityService.cs:line 1420
[2025-10-09 22:03:22 INF] üåç Ajout g√©olocalisation
[2025-10-09 22:03:22 INF] ‚úÖ G√©olocalisation ajout√©e
[2025-10-09 22:03:22 INF] ‚è∞ Configuration expiration: 3 jours
[2025-10-09 22:03:22 INF] ‚úÖ Expiration configur√©e
[2025-10-09 22:03:22 INF] üåê Enregistrement IP: 127.0.0.1
[2025-10-09 22:03:22 INF] ‚úÖ IP enregistr√©e
[2025-10-09 22:03:22 INF] üìÑ Application filigrane dynamique
[2025-10-09 22:03:22 ERR] ‚ùå Erreur filigrane dynamique
System.InvalidOperationException: No appropriate font found for family name 'Arial'. Implement IFontResolver and assign to 'GlobalFontSettings.FontResolver' to use fonts. See https://docs.pdfsharp.net/link/font-resolving.html
   at PdfSharp.Drawing.XGlyphTypeface.GetOrCreateFrom(String familyName, FontResolvingOptions fontResolvingOptions)
   at PdfSharp.Drawing.XFont.Initialize()
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style, XPdfFontOptions pdfOptions)
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style)
   at SecureDocumentPdf.Services.PdfSecurityService.ApplyDynamicPageWatermarksAsync(String inputPath, String userName, String documentId) in C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\Services\PdfSecurityService.cs:line 1570
[2025-10-09 22:03:22 INF] üì∏ Ajout protection capture √©cran
[2025-10-09 22:03:22 ERR] ‚ùå Erreur protection √©cran
System.InvalidOperationException: No appropriate font found for family name 'Arial'. Implement IFontResolver and assign to 'GlobalFontSettings.FontResolver' to use fonts. See https://docs.pdfsharp.net/link/font-resolving.html
   at PdfSharp.Drawing.XGlyphTypeface.GetOrCreateFrom(String familyName, FontResolvingOptions fontResolvingOptions)
   at PdfSharp.Drawing.XFont.Initialize()
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style, XPdfFontOptions pdfOptions)
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style)
   at SecureDocumentPdf.Services.PdfSecurityService.AddScreenCaptureProtectionAsync(String inputPath, String documentId) in C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\Services\PdfSecurityService.cs:line 1617
[2025-10-09 22:03:22 INF] üè∑Ô∏è Application du watermark de s√©curit√©: 921ca989-016f-4f7f-a91e-7cde29e0f6a2_Menu_Salades_Plats_cleaned_invisible.pdf
[2025-10-09 22:03:22 ERR] ‚ùå Erreur lors de l'application du watermark: C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\uploads\921ca989-016f-4f7f-a91e-7cde29e0f6a2_Menu_Salades_Plats_cleaned_invisible.pdf
System.InvalidOperationException: No appropriate font found for family name 'Arial'. Implement IFontResolver and assign to 'GlobalFontSettings.FontResolver' to use fonts. See https://docs.pdfsharp.net/link/font-resolving.html
   at PdfSharp.Drawing.XGlyphTypeface.GetOrCreateFrom(String familyName, FontResolvingOptions fontResolvingOptions)
   at PdfSharp.Drawing.XFont.Initialize()
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style, XPdfFontOptions pdfOptions)
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style)
   at SecureDocumentPdf.Services.PdfSecurityService.ApplySecurityWatermarkAsync(String inputPath, String userName) in C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\Services\PdfSecurityService.cs:line 230
[2025-10-09 22:03:22 INF] üñ®Ô∏è Ajout watermark impression
[2025-10-09 22:03:22 ERR] ‚ùå Erreur watermark impression
System.InvalidOperationException: No appropriate font found for family name 'Arial'. Implement IFontResolver and assign to 'GlobalFontSettings.FontResolver' to use fonts. See https://docs.pdfsharp.net/link/font-resolving.html
   at PdfSharp.Drawing.XGlyphTypeface.GetOrCreateFrom(String familyName, FontResolvingOptions fontResolvingOptions)
   at PdfSharp.Drawing.XFont.Initialize()
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style, XPdfFontOptions pdfOptions)
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style)
   at SecureDocumentPdf.Services.PdfSecurityService.AddPrintOnlyWatermarkAsync(String inputPath, String userName) in C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\Services\PdfSecurityService.cs:line 1662
[2025-10-09 22:03:22 INF] üìú Application de la signature num√©rique PAdES: 921ca989-016f-4f7f-a91e-7cde29e0f6a2_Menu_Salades_Plats_cleaned_invisible.pdf
[2025-10-09 22:03:22 INF] üîê Signature num√©rique PAdES simul√©e appliqu√©e: 921ca989-016f-4f7f-a91e-7cde29e0f6a2_Menu_Salades_Plats_cleaned_invisible_signed.pdf
[2025-10-09 22:03:22 INF] üìã Certificat g√©n√©r√© - Subject: CN=Test,O=PDF Security User,C=FR
[2025-10-09 22:03:22 INF] üîí Application de la protection par chiffrement: 921ca989-016f-4f7f-a91e-7cde29e0f6a2_Menu_Salades_Plats_cleaned_invisible_signed.pdf
[2025-10-09 22:03:22 INF] üîê PDF prot√©g√© par chiffrement 128-bit. Mot de passe: PDF_***4ZT
[2025-10-09 22:03:22 INF] üîë Mot de passe sauvegard√© de mani√®re s√©curis√©e: PASSWORD_921ca989-016f-4f7f-a91e-7cde29e0f6a2_Menu_Salades_Plats_cleaned_invisible_signed_protected.json
[2025-10-09 22:03:22 INF] ‚úÖ PDF prot√©g√© valid√© - Lecture OK, modification bloqu√©e
[2025-10-09 22:03:22 INF] ‚úÖ Protection valid√©e - PDF verrouill√© avec succ√®s
[2025-10-09 22:03:22 INF] ‚è∞ Horodatage RFC3161 g√©n√©r√©: RFC3161-2025-10-09T20:03:22.683Z-NONCE:a3ed52fbad164bc3-MOCK
[2025-10-09 22:03:22 INF] üì± G√©n√©ration QR Code
[2025-10-09 22:03:22 INF] ‚úÖ QR Code g√©n√©r√©
[2025-10-09 22:03:22 INF] üñºÔ∏è G√©n√©ration pr√©visualisations
[2025-10-09 22:03:22 INF] üì∏ Pr√©visualisation g√©n√©r√©e
[2025-10-09 22:03:22 INF] üìã G√©n√©ration journal d'audit
[2025-10-09 22:03:22 INF] ‚úÖ Journal d'audit g√©n√©r√©
[2025-10-09 22:03:22 INF] üìã G√©n√©ration certificat de preuve enrichi
[2025-10-09 22:03:22 INF] ‚è∞ Horodatage RFC3161 g√©n√©r√©: RFC3161-2025-10-09T20:03:22.939Z-NONCE:c5a3f6ec5155494c-MOCK
[2025-10-09 22:03:22 INF] ‚úÖ Certificat de preuve enrichi g√©n√©r√©
[2025-10-09 22:03:22 INF] üéâ Traitement PDF ULTRA-S√âCURIS√â termin√© avec succ√®s pour Test en 1.01s
[2025-10-09 22:03:22 INF] ‚úÖ Traitement r√©ussi - PDF s√©curis√©: /secured/SECURED_20251009_220322_Menu_Salades_Plats.pdf, Dur√©e: 1.0145925s
[2025-10-09 22:04:07 INF] üì§ Soumission formulaire - Utilisateur: Test
[2025-10-09 22:04:07 INF] üìã Type d√©tect√©: Tableur Excel
[2025-10-09 22:04:07 INF] üîÑ D√©but traitement - Type: Tableur Excel, Taille: 9784 bytes
[2025-10-09 22:04:07 INF] üîÑ Conversion vers PDF n√©cessaire...
[2025-10-09 22:04:08 INF] üîÑ Conversion .xlsx ‚Üí PDF
[2025-10-09 22:04:09 ERR] ‚ùå √âchec conversion PDF
[2025-10-09 22:04:29 INF] üì§ Soumission formulaire - Utilisateur: Test
[2025-10-09 22:04:29 INF] üìã Type d√©tect√©: Tableur Excel
[2025-10-09 22:04:29 INF] üîÑ D√©but traitement - Type: Tableur Excel, Taille: 9784 bytes
[2025-10-09 22:04:29 INF] üîÑ Conversion vers PDF n√©cessaire...
[2025-10-09 22:04:39 INF] üîÑ Conversion .xlsx ‚Üí PDF
[2025-10-09 22:10:22 INF] ========================================
[2025-10-09 22:10:22 INF] Application PDF Security d√©marr√©e
[2025-10-09 22:10:22 INF] ========================================
[2025-10-09 22:10:22 INF] Mode : Development
[2025-10-09 22:10:22 INF] Dossiers cr√©√©s avec succ√®s
[2025-10-09 22:10:22 INF]   - Uploads : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\uploads
[2025-10-09 22:10:22 INF]   - Secured : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\secured
[2025-10-09 22:10:22 INF]   - Previews : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\secured\previews
[2025-10-09 22:10:22 INF] ========================================
[2025-10-09 22:10:22 INF] Application pr√™te !
[2025-10-09 22:10:22 INF] URL : https://localhost:7001
[2025-10-09 22:10:22 INF] Environment : Development
[2025-10-09 22:10:22 INF] ========================================
[2025-10-09 22:10:25 INF] üìÑ Page Index charg√©e - Support multi-formats activ√©
[2025-10-09 22:10:52 INF] üì§ Soumission formulaire - Utilisateur: test
[2025-10-09 22:10:52 INF] üìã Type d√©tect√©: Tableur Excel
[2025-10-09 22:10:52 INF] üîÑ D√©but traitement - Type: Tableur Excel, Taille: 9784 bytes
[2025-10-09 22:10:52 INF] üîÑ Conversion vers PDF n√©cessaire...
[2025-10-09 22:10:53 INF] üîÑ Conversion .xlsx ‚Üí PDF
[2025-10-09 22:10:56 INF] ‚úÖ Conversion PDF r√©ussie: Suivi_Plan_SEO_La_Grande_Bleue.pdf
[2025-10-09 22:10:56 INF] üîí Lancement s√©curisation maximale...
[2025-10-09 22:10:56 INF] üîê [v3.0] D√©but du traitement PDF ULTRA-S√âCURIS√â pour test: Suivi_Plan_SEO_La_Grande_Bleue.pdf
[2025-10-09 22:10:56 INF] üßπ Nettoyage des m√©tadonn√©es: 8edefedb-8ff6-46c9-a0d5-2450e918f3da_Suivi_Plan_SEO_La_Grande_Bleue.pdf
[2025-10-09 22:10:56 INF] ‚ú® M√©tadonn√©es nettoy√©es avec succ√®s: 8edefedb-8ff6-46c9-a0d5-2450e918f3da_Suivi_Plan_SEO_La_Grande_Bleue_cleaned.pdf
[2025-10-09 22:10:56 INF] üîç Ajout du watermark invisible et empreinte
[2025-10-09 22:10:56 INF] ‚úÖ Watermark invisible ajout√©
[2025-10-09 22:10:56 INF] üî¢ G√©n√©ration des hash par page
[2025-10-09 22:10:56 ERR] ‚ùå Erreur g√©n√©ration hash pages
System.InvalidOperationException: A PDF document must be opened with PdfDocumentOpenMode.Import to import pages from it.
   at PdfSharp.Pdf.PdfPages.ImportExternalPage(PdfPage importPage)
   at PdfSharp.Pdf.PdfPages.Insert(Int32 index, PdfPage page)
   at PdfSharp.Pdf.PdfPages.Add(PdfPage page)
   at PdfSharp.Pdf.PdfDocument.AddPage(PdfPage page)
   at SecureDocumentPdf.Services.PdfSecurityService.GenerateAndSavePageHashesAsync(String pdfPath, String documentId) in C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\Services\PdfSecurityService.cs:line 1420
[2025-10-09 22:10:56 INF] üåç Ajout g√©olocalisation
[2025-10-09 22:10:56 INF] ‚úÖ G√©olocalisation ajout√©e
[2025-10-09 22:10:56 INF] ‚è∞ Configuration expiration: 4 jours
[2025-10-09 22:10:56 INF] ‚úÖ Expiration configur√©e
[2025-10-09 22:10:56 INF] üåê Enregistrement IP: 127.0.0.1
[2025-10-09 22:10:56 INF] ‚úÖ IP enregistr√©e
[2025-10-09 22:10:56 INF] üìÑ Application filigrane dynamique
[2025-10-09 22:10:57 ERR] ‚ùå Erreur filigrane dynamique
System.InvalidOperationException: No appropriate font found for family name 'Arial'. Implement IFontResolver and assign to 'GlobalFontSettings.FontResolver' to use fonts. See https://docs.pdfsharp.net/link/font-resolving.html
   at PdfSharp.Drawing.XGlyphTypeface.GetOrCreateFrom(String familyName, FontResolvingOptions fontResolvingOptions)
   at PdfSharp.Drawing.XFont.Initialize()
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style, XPdfFontOptions pdfOptions)
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style)
   at SecureDocumentPdf.Services.PdfSecurityService.ApplyDynamicPageWatermarksAsync(String inputPath, String userName, String documentId) in C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\Services\PdfSecurityService.cs:line 1570
[2025-10-09 22:10:57 INF] üì∏ Ajout protection capture √©cran
[2025-10-09 22:10:57 ERR] ‚ùå Erreur protection √©cran
System.InvalidOperationException: No appropriate font found for family name 'Arial'. Implement IFontResolver and assign to 'GlobalFontSettings.FontResolver' to use fonts. See https://docs.pdfsharp.net/link/font-resolving.html
   at PdfSharp.Drawing.XGlyphTypeface.GetOrCreateFrom(String familyName, FontResolvingOptions fontResolvingOptions)
   at PdfSharp.Drawing.XFont.Initialize()
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style, XPdfFontOptions pdfOptions)
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style)
   at SecureDocumentPdf.Services.PdfSecurityService.AddScreenCaptureProtectionAsync(String inputPath, String documentId) in C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\Services\PdfSecurityService.cs:line 1617
[2025-10-09 22:10:57 INF] üè∑Ô∏è Application du watermark de s√©curit√©: 8edefedb-8ff6-46c9-a0d5-2450e918f3da_Suivi_Plan_SEO_La_Grande_Bleue_cleaned_invisible.pdf
[2025-10-09 22:10:57 ERR] ‚ùå Erreur lors de l'application du watermark: C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\uploads\8edefedb-8ff6-46c9-a0d5-2450e918f3da_Suivi_Plan_SEO_La_Grande_Bleue_cleaned_invisible.pdf
System.InvalidOperationException: No appropriate font found for family name 'Arial'. Implement IFontResolver and assign to 'GlobalFontSettings.FontResolver' to use fonts. See https://docs.pdfsharp.net/link/font-resolving.html
   at PdfSharp.Drawing.XGlyphTypeface.GetOrCreateFrom(String familyName, FontResolvingOptions fontResolvingOptions)
   at PdfSharp.Drawing.XFont.Initialize()
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style, XPdfFontOptions pdfOptions)
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style)
   at SecureDocumentPdf.Services.PdfSecurityService.ApplySecurityWatermarkAsync(String inputPath, String userName) in C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\Services\PdfSecurityService.cs:line 230
[2025-10-09 22:10:57 INF] üñ®Ô∏è Ajout watermark impression
[2025-10-09 22:10:57 ERR] ‚ùå Erreur watermark impression
System.InvalidOperationException: No appropriate font found for family name 'Arial'. Implement IFontResolver and assign to 'GlobalFontSettings.FontResolver' to use fonts. See https://docs.pdfsharp.net/link/font-resolving.html
   at PdfSharp.Drawing.XGlyphTypeface.GetOrCreateFrom(String familyName, FontResolvingOptions fontResolvingOptions)
   at PdfSharp.Drawing.XFont.Initialize()
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style, XPdfFontOptions pdfOptions)
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style)
   at SecureDocumentPdf.Services.PdfSecurityService.AddPrintOnlyWatermarkAsync(String inputPath, String userName) in C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\Services\PdfSecurityService.cs:line 1662
[2025-10-09 22:10:57 INF] üìú Application de la signature num√©rique PAdES: 8edefedb-8ff6-46c9-a0d5-2450e918f3da_Suivi_Plan_SEO_La_Grande_Bleue_cleaned_invisible.pdf
[2025-10-09 22:10:59 INF] üîê Signature num√©rique PAdES simul√©e appliqu√©e: 8edefedb-8ff6-46c9-a0d5-2450e918f3da_Suivi_Plan_SEO_La_Grande_Bleue_cleaned_invisible_signed.pdf
[2025-10-09 22:10:59 INF] üìã Certificat g√©n√©r√© - Subject: CN=test,O=PDF Security User,C=FR
[2025-10-09 22:10:59 INF] üîí Application de la protection par chiffrement: 8edefedb-8ff6-46c9-a0d5-2450e918f3da_Suivi_Plan_SEO_La_Grande_Bleue_cleaned_invisible_signed.pdf
[2025-10-09 22:10:59 INF] üîê PDF prot√©g√© par chiffrement 128-bit. Mot de passe: PDF_***pSy
[2025-10-09 22:10:59 INF] üîë Mot de passe sauvegard√© de mani√®re s√©curis√©e: PASSWORD_8edefedb-8ff6-46c9-a0d5-2450e918f3da_Suivi_Plan_SEO_La_Grande_Bleue_cleaned_invisible_signed_protected.json
[2025-10-09 22:10:59 INF] ‚úÖ PDF prot√©g√© valid√© - Lecture OK, modification bloqu√©e
[2025-10-09 22:10:59 INF] ‚úÖ Protection valid√©e - PDF verrouill√© avec succ√®s
[2025-10-09 22:10:59 INF] ‚è∞ Horodatage RFC3161 g√©n√©r√©: RFC3161-2025-10-09T20:10:59.569Z-NONCE:c1ec3b2c19194f81-MOCK
[2025-10-09 22:10:59 INF] üì± G√©n√©ration QR Code
[2025-10-09 22:10:59 INF] ‚úÖ QR Code g√©n√©r√©
[2025-10-09 22:10:59 INF] üñºÔ∏è G√©n√©ration pr√©visualisations
[2025-10-09 22:11:00 INF] üì∏ Pr√©visualisation g√©n√©r√©e
[2025-10-09 22:11:00 INF] üìã G√©n√©ration journal d'audit
[2025-10-09 22:11:00 INF] ‚úÖ Journal d'audit g√©n√©r√©
[2025-10-09 22:11:00 INF] üìã G√©n√©ration certificat de preuve enrichi
[2025-10-09 22:11:00 INF] ‚è∞ Horodatage RFC3161 g√©n√©r√©: RFC3161-2025-10-09T20:11:00.691Z-NONCE:f0db055233574c36-MOCK
[2025-10-09 22:11:00 INF] ‚úÖ Certificat de preuve enrichi g√©n√©r√©
[2025-10-09 22:11:00 INF] üéâ Traitement PDF ULTRA-S√âCURIS√â termin√© avec succ√®s pour test en 4.37s
[2025-10-09 22:11:00 INF] ‚úÖ Traitement r√©ussi - PDF s√©curis√©: /secured/SECURED_20251009_221100_Suivi_Plan_SEO_La_Grande_Bleue.pdf, Dur√©e: 4.372187s
