[2025-10-19 10:58:17 INF] ========================================
[2025-10-19 10:58:17 INF] Application PDF Security d√©marr√©e
[2025-10-19 10:58:17 INF] ========================================
[2025-10-19 10:58:17 INF] Mode : Development
[2025-10-19 10:58:18 INF] Dossiers cr√©√©s avec succ√®s
[2025-10-19 10:58:18 INF]   - Uploads : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\uploads
[2025-10-19 10:58:18 INF]   - Secured : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\secured
[2025-10-19 10:58:18 INF]   - Previews : C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\secured\previews
[2025-10-19 10:58:18 INF] ========================================
[2025-10-19 10:58:18 INF] Application pr√™te !
[2025-10-19 10:58:18 INF] URL : https://localhost:7001
[2025-10-19 10:58:18 INF] Environment : Development
[2025-10-19 10:58:18 INF] ========================================
[2025-10-19 10:58:23 INF] üìÑ Page Index charg√©e - Support multi-formats activ√©
[2025-10-19 10:58:43 INF] üì§ Soumission formulaire - Utilisateur: Test
[2025-10-19 10:58:43 INF] üìã Type d√©tect√©: Pr√©sentation PowerPoint
[2025-10-19 10:58:43 INF] üîÑ D√©but traitement - Type: Pr√©sentation PowerPoint, Taille: 3973199 bytes
[2025-10-19 10:58:43 INF] üîÑ Conversion vers PDF n√©cessaire...
[2025-10-19 10:58:43 INF] üîÑ Conversion .pptx ‚Üí PDF
[2025-10-19 10:58:44 ERR] ‚ùå √âchec conversion PDF
[2025-10-19 10:58:56 INF] üì§ Soumission formulaire - Utilisateur: Test
[2025-10-19 10:58:56 INF] üìã Type d√©tect√©: Image
[2025-10-19 10:58:56 INF] üîÑ D√©but traitement - Type: Image, Taille: 1150579 bytes
[2025-10-19 10:58:56 INF] üîÑ Conversion vers PDF n√©cessaire...
[2025-10-19 10:58:56 INF] üîÑ Conversion .png ‚Üí PDF
[2025-10-19 10:58:57 INF] ‚úÖ Conversion PDF r√©ussie: Copilot_20251018_143539.pdf
[2025-10-19 10:58:57 INF] üîí Lancement s√©curisation maximale...
[2025-10-19 10:58:57 INF] üîê [v3.0] D√©but du traitement PDF ULTRA-S√âCURIS√â pour Test: Copilot_20251018_143539.pdf
[2025-10-19 10:58:57 INF] üßπ Nettoyage des m√©tadonn√©es: 5b901e52-4cde-4328-97dd-84923fb250ea_Copilot_20251018_143539.pdf
[2025-10-19 10:58:57 INF] ‚ú® M√©tadonn√©es nettoy√©es avec succ√®s: 5b901e52-4cde-4328-97dd-84923fb250ea_Copilot_20251018_143539_cleaned.pdf
[2025-10-19 10:58:57 INF] üîç Ajout du watermark invisible et empreinte
[2025-10-19 10:58:57 INF] ‚úÖ Watermark invisible ajout√©
[2025-10-19 10:58:57 INF] üî¢ G√©n√©ration des hash par page
[2025-10-19 10:58:57 ERR] ‚ùå Erreur g√©n√©ration hash pages
System.InvalidOperationException: A PDF document must be opened with PdfDocumentOpenMode.Import to import pages from it.
   at PdfSharp.Pdf.PdfPages.ImportExternalPage(PdfPage importPage)
   at PdfSharp.Pdf.PdfPages.Insert(Int32 index, PdfPage page)
   at PdfSharp.Pdf.PdfPages.Add(PdfPage page)
   at PdfSharp.Pdf.PdfDocument.AddPage(PdfPage page)
   at SecureDocumentPdf.Services.PdfSecurityService.GenerateAndSavePageHashesAsync(String pdfPath, String documentId) in C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\Services\PdfSecurityService.cs:line 1419
[2025-10-19 10:58:57 INF] üåç Ajout g√©olocalisation
[2025-10-19 10:58:57 INF] ‚úÖ G√©olocalisation ajout√©e
[2025-10-19 10:58:57 INF] ‚è∞ Configuration expiration: 2 jours
[2025-10-19 10:58:58 INF] ‚úÖ Expiration configur√©e
[2025-10-19 10:58:58 INF] üåê Enregistrement IP: 127.0.0.1
[2025-10-19 10:58:58 INF] ‚úÖ IP enregistr√©e
[2025-10-19 10:58:58 INF] üìÑ Application filigrane dynamique
[2025-10-19 10:58:58 ERR] ‚ùå Erreur filigrane dynamique
System.InvalidOperationException: No appropriate font found for family name 'Arial'. Implement IFontResolver and assign to 'GlobalFontSettings.FontResolver' to use fonts. See https://docs.pdfsharp.net/link/font-resolving.html
   at PdfSharp.Drawing.XGlyphTypeface.GetOrCreateFrom(String familyName, FontResolvingOptions fontResolvingOptions)
   at PdfSharp.Drawing.XFont.Initialize()
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style, XPdfFontOptions pdfOptions)
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style)
   at SecureDocumentPdf.Services.PdfSecurityService.ApplyDynamicPageWatermarksAsync(String inputPath, String userName, String documentId) in C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\Services\PdfSecurityService.cs:line 1569
[2025-10-19 10:58:58 INF] üì∏ Ajout protection capture √©cran
[2025-10-19 10:58:58 ERR] ‚ùå Erreur protection √©cran
System.InvalidOperationException: No appropriate font found for family name 'Arial'. Implement IFontResolver and assign to 'GlobalFontSettings.FontResolver' to use fonts. See https://docs.pdfsharp.net/link/font-resolving.html
   at PdfSharp.Drawing.XGlyphTypeface.GetOrCreateFrom(String familyName, FontResolvingOptions fontResolvingOptions)
   at PdfSharp.Drawing.XFont.Initialize()
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style, XPdfFontOptions pdfOptions)
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style)
   at SecureDocumentPdf.Services.PdfSecurityService.AddScreenCaptureProtectionAsync(String inputPath, String documentId) in C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\Services\PdfSecurityService.cs:line 1616
[2025-10-19 10:58:58 INF] üè∑Ô∏è Application du watermark de s√©curit√©: 5b901e52-4cde-4328-97dd-84923fb250ea_Copilot_20251018_143539_cleaned_invisible.pdf
[2025-10-19 10:58:58 ERR] ‚ùå Erreur lors de l'application du watermark: C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\wwwroot\uploads\5b901e52-4cde-4328-97dd-84923fb250ea_Copilot_20251018_143539_cleaned_invisible.pdf
System.InvalidOperationException: No appropriate font found for family name 'Arial'. Implement IFontResolver and assign to 'GlobalFontSettings.FontResolver' to use fonts. See https://docs.pdfsharp.net/link/font-resolving.html
   at PdfSharp.Drawing.XGlyphTypeface.GetOrCreateFrom(String familyName, FontResolvingOptions fontResolvingOptions)
   at PdfSharp.Drawing.XFont.Initialize()
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style, XPdfFontOptions pdfOptions)
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style)
   at SecureDocumentPdf.Services.PdfSecurityService.ApplySecurityWatermarkAsync(String inputPath, String userName) in C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\Services\PdfSecurityService.cs:line 229
[2025-10-19 10:58:58 INF] üñ®Ô∏è Ajout watermark impression
[2025-10-19 10:58:58 ERR] ‚ùå Erreur watermark impression
System.InvalidOperationException: No appropriate font found for family name 'Arial'. Implement IFontResolver and assign to 'GlobalFontSettings.FontResolver' to use fonts. See https://docs.pdfsharp.net/link/font-resolving.html
   at PdfSharp.Drawing.XGlyphTypeface.GetOrCreateFrom(String familyName, FontResolvingOptions fontResolvingOptions)
   at PdfSharp.Drawing.XFont.Initialize()
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style, XPdfFontOptions pdfOptions)
   at PdfSharp.Drawing.XFont..ctor(String familyName, Double emSize, XFontStyleEx style)
   at SecureDocumentPdf.Services.PdfSecurityService.AddPrintOnlyWatermarkAsync(String inputPath, String userName) in C:\Users\gachg\source\repos\SecureDocumentPdf\SecureDocumentPdf\Services\PdfSecurityService.cs:line 1661
[2025-10-19 10:58:58 INF] üìú Application de la signature num√©rique PAdES: 5b901e52-4cde-4328-97dd-84923fb250ea_Copilot_20251018_143539_cleaned_invisible.pdf
[2025-10-19 10:58:59 INF] üîê Signature num√©rique PAdES simul√©e appliqu√©e: 5b901e52-4cde-4328-97dd-84923fb250ea_Copilot_20251018_143539_cleaned_invisible_signed.pdf
[2025-10-19 10:58:59 INF] üìã Certificat g√©n√©r√© - Subject: CN=Test,O=PDF Security User,C=FR
[2025-10-19 10:58:59 INF] üîí Application de la protection par chiffrement: 5b901e52-4cde-4328-97dd-84923fb250ea_Copilot_20251018_143539_cleaned_invisible_signed.pdf
[2025-10-19 10:58:59 INF] üîê PDF prot√©g√© par chiffrement 128-bit. Mot de passe: PDF_***tIO
[2025-10-19 10:58:59 INF] üîë Mot de passe sauvegard√© de mani√®re s√©curis√©e: PASSWORD_5b901e52-4cde-4328-97dd-84923fb250ea_Copilot_20251018_143539_cleaned_invisible_signed_protected.json
[2025-10-19 10:58:59 INF] ‚úÖ PDF prot√©g√© valid√© - Lecture OK, modification bloqu√©e
[2025-10-19 10:58:59 INF] ‚úÖ Protection valid√©e - PDF verrouill√© avec succ√®s
[2025-10-19 10:58:59 INF] ‚è∞ Horodatage RFC3161 g√©n√©r√©: RFC3161-2025-10-19T08:58:59.975Z-NONCE:e066124236f44f0e-MOCK
[2025-10-19 10:58:59 INF] üì± G√©n√©ration QR Code
[2025-10-19 10:59:00 INF] ‚úÖ QR Code g√©n√©r√©
[2025-10-19 10:59:00 INF] üñºÔ∏è G√©n√©ration pr√©visualisations
[2025-10-19 10:59:01 INF] üì∏ Pr√©visualisation g√©n√©r√©e
[2025-10-19 10:59:01 INF] üìã G√©n√©ration journal d'audit
[2025-10-19 10:59:01 INF] ‚úÖ Journal d'audit g√©n√©r√©
[2025-10-19 10:59:01 INF] üìã G√©n√©ration certificat de preuve enrichi
[2025-10-19 10:59:01 INF] ‚è∞ Horodatage RFC3161 g√©n√©r√©: RFC3161-2025-10-19T08:59:01.740Z-NONCE:2fc7c72d58f34276-MOCK
[2025-10-19 10:59:01 INF] ‚úÖ Certificat de preuve enrichi g√©n√©r√©
[2025-10-19 10:59:01 INF] üéâ Traitement PDF ULTRA-S√âCURIS√â termin√© avec succ√®s pour Test en 4.42s
[2025-10-19 10:59:01 INF] ‚úÖ Traitement r√©ussi - PDF s√©curis√©: /secured/SECURED_20251019_105901_Copilot_20251018_143539.pdf, Dur√©e: 4.4234973s
[2025-10-19 11:00:24 INF] Page visualiseur PDF charg√©e
[2025-10-19 11:00:31 INF] Validation PDF r√©ussie pour SECURED_20251019_105901_Copilot_20251018_143539.pdf
[2025-10-19 11:00:31 INF] PDF valid√© avec succ√®s: SECURED_20251019_105901_Copilot_20251018_143539.pdf
[2025-10-19 11:00:40 INF] Page visualiseur PDF charg√©e
[2025-10-19 11:00:42 INF] Page transfert chargee - Mode: upload
[2025-10-19 11:00:58 INF] Transfert cree : 901b73b81ed14b4abbca29d9ccfba1ab, Fichier : SECURED_20251019_105901_Copilot_20251018_143539.pdf, Taille : 45502 bytes
[2025-10-19 11:00:58 INF] Transfert cr√©√© avec succ√®s : 901b73b81ed14b4abbca29d9ccfba1ab
[2025-10-19 11:01:03 INF] Page transfert chargee - Mode: upload
[2025-10-19 11:01:03 INF] Mode download detecte - TransferId: 901b73b81ed14b4abbca29d9ccfba1ab
[2025-10-19 11:01:07 INF] T√©l√©chargement reussi : 901b73b81ed14b4abbca29d9ccfba1ab, T√©l√©chargements : 1/10
[2025-10-19 11:01:16 INF] üìÑ Page Index charg√©e - Support multi-formats activ√©
