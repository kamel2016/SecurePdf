@* @page
@model SecureDocumentPdf.Pages.IndexModel
@{
    ViewData["Title"] = "Sécurisation PDF";
}

<div class="row justify-content-center mt-4">
    <div class="col-lg-10">
        <!-- En-tête avec titre et description -->
        <div class="text-center mb-5">
            <h1 class="display-3 text-primary mb-3 fw-bold">
                <i class="fas fa-file-shield me-3"></i>
                Sécurisation PDF Professionnelle
            </h1>
            <p class="lead text-muted fs-5">
                Protégez vos documents PDF avec signature numérique, watermark, horodatage et nettoyage des métadonnées
            </p>
        </div>

        <!-- Carte principale de l'application -->
        <div class="card shadow-lg border-0 rounded-4">
            <div class="card-header bg-gradient-primary text-white py-4">
                <h4 class="card-title mb-0 fs-3">
                    <i class="fas fa-upload me-2"></i>
                    Télécharger et Sécuriser votre PDF
                </h4>
            </div>
            <div class="card-body p-5">

                <!-- Formulaire d'upload -->
                <form method="post" enctype="multipart/form-data" id="uploadForm" novalidate>
                    @Html.AntiForgeryToken()

                    <!-- Nom utilisateur -->
                    <div class="mb-4">
                        <label asp-for="UserName" class="form-label fw-bold fs-5">
                            <i class="fas fa-user me-2 text-primary"></i>Nom d'utilisateur
                        </label>
                        <input asp-for="UserName" class="form-control form-control-lg shadow-sm"
                               placeholder="Votre nom ou identifiant" />
                        <span asp-validation-for="UserName" class="text-danger"></span>
                    </div>

                    <!-- Zone de drag & drop AMÉLIORÉE ET PLUS GRANDE -->
                    <div class="mb-4">
                        <label asp-for="PdfFile" class="form-label fw-bold fs-5 mb-3">
                            <i class="fas fa-file-pdf me-2 text-primary"></i>Fichier PDF à sécuriser
                        </label>

                        <div class="file-drop-area-large" id="fileDropArea">
                            <div class="file-drop-content">
                                <div class="file-drop-icon-large mb-4">
                                    <i class="fas fa-cloud-upload-alt fa-6x text-primary"></i>
                                </div>
                                <div class="file-drop-text-large">
                                    <h3 class="fw-bold text-dark mb-3">Glissez-déposez votre PDF ici</h3>
                                    <p class="fs-5 text-muted mb-4">ou</p>
                                    <button type="button" class="btn btn-primary btn-lg px-5 py-3 shadow" onclick="document.getElementById('pdfFileInput').click()">
                                        <i class="fas fa-folder-open me-2"></i>
                                        Parcourir les fichiers
                                    </button>
                                </div>
                                <input asp-for="PdfFile" type="file" class="file-input"
                                       id="pdfFileInput" accept=".pdf,application/pdf" style="display: none;" />
                            </div>

                            <!-- Informations fichier sélectionné -->
                            <div class="file-selected-info-large" id="fileInfoDisplay" style="display: none;">
                                <div class="d-flex align-items-center justify-content-between">
                                    <div class="d-flex align-items-center">
                                        <i class="fas fa-file-pdf fa-3x text-danger me-4"></i>
                                        <div>
                                            <h5 class="mb-1 fw-bold" id="fileName">Document.pdf</h5>
                                            <p class="mb-0 text-muted" id="fileSize">0 MB</p>
                                        </div>
                                    </div>
                                    <button type="button" class="btn btn-outline-danger btn-sm" onclick="resetFileSelection()">
                                        <i class="fas fa-times me-1"></i> Supprimer
                                    </button>
                                </div>
                            </div>
                        </div>

                        <span asp-validation-for="PdfFile" class="text-danger"></span>
                        <div class="form-text mt-3">
                            <i class="fas fa-info-circle me-1"></i>
                            Format accepté : <strong>PDF uniquement</strong> • Taille maximale : <strong>50 MB</strong>
                        </div>
                    </div>

                    <!-- Informations sur le traitement -->
                    <div class="alert alert-info border-0 shadow-sm rounded-3 mb-4" role="alert">
                        <h6 class="alert-heading fw-bold fs-5 mb-3">
                            <i class="fas fa-shield-alt me-2"></i>Traitements de sécurité appliqués :
                        </h6>
                        <div class="row g-3">
                            <div class="col-md-4">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-check-circle text-success fs-4 me-2"></i>
                                    <span>Signature PAdES</span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-check-circle text-success fs-4 me-2"></i>
                                    <span>Hash SHA256</span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-check-circle text-success fs-4 me-2"></i>
                                    <span>Horodatage RFC3161</span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-check-circle text-success fs-4 me-2"></i>
                                    <span>Watermark personnalisé</span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-check-circle text-success fs-4 me-2"></i>
                                    <span>Nettoyage métadonnées</span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-check-circle text-success fs-4 me-2"></i>
                                    <span>Preuve cryptographique</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Bouton de traitement -->
                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary btn-lg py-3 fs-4 shadow-lg" id="submitBtn">
                            <i class="fas fa-shield-alt me-2"></i>
                            Sécuriser mon PDF
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Affichage des résultats après traitement -->
        @if (Model.Result != null)
        {
            <div class="mt-4" id="resultArea">
                @if (Model.Result.Success)
                {
                    <!-- Succès -->
                    <div class="card border-success result-card-enter shadow-lg">
                        <div class="card-header bg-success text-white py-3">
                            <h5 class="card-title mb-0 fs-4">
                                <i class="fas fa-check-circle me-2"></i>
                                PDF Sécurisé avec Succès !
                            </h5>
                        </div>
                        <div class="card-body p-4">
                            <p class="card-text mb-3 fs-5">
                                Votre document PDF a été traité et sécurisé. Vous pouvez maintenant télécharger :
                            </p>

                            <div class="row g-3">
                                <div class="col-md-6">
                                    <a href="@Model.Result.SecuredPdfPath" class="btn btn-outline-success w-100 py-3" download>
                                        <i class="fas fa-download me-2"></i>
                                        Télécharger le PDF sécurisé
                                    </a>
                                </div>
                                <div class="col-md-6">
                                    <a href="@Model.Result.ProofFilePath" class="btn btn-outline-info w-100 py-3" download>
                                        <i class="fas fa-certificate me-2"></i>
                                        Télécharger le fichier de preuve
                                    </a>
                                </div>
                            </div>

                            <!-- Informations détaillées -->
                            <div class="mt-4 p-3 bg-light rounded">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <h6 class="text-success fw-bold">Hash original :</h6>
                                        <small class="text-monospace">@Model.Result.OriginalHash</small>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="text-success fw-bold">Hash traité :</h6>
                                        <small class="text-monospace">@Model.Result.ProcessedHash</small>
                                    </div>
                                </div>
                                <div class="mt-2">
                                    <h6 class="text-success fw-bold">Traité le :</h6>
                                    <small>@Model.Result.ProcessedAt.ToString("dd/MM/yyyy HH:mm:ss")</small>
                                </div>
                            </div>

                            <!-- Étapes de traitement réalisées -->
                            @if (Model.Result.ProcessingSteps.Any())
                            {
                                <div class="mt-4">
                                    <h6 class="text-success fw-bold mb-3">Traitements appliqués :</h6>
                                    @foreach (var step in Model.Result.ProcessingSteps)
                                    {
                                        <div class="processing-step completed small mb-2">
                                            <i class="fas fa-check-circle text-success me-2"></i>@step
                                        </div>
                                    }
                                </div>
                            }
                        </div>
                    </div>
                }
                else
                {
                    <!-- Erreur -->
                    <div class="card border-danger result-card-enter shadow-lg">
                        <div class="card-header bg-danger text-white py-3">
                            <h5 class="card-title mb-0 fs-4">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                Erreur de Traitement
                            </h5>
                        </div>
                        <div class="card-body p-4">
                            <div class="text-danger fs-5 mb-2">@Model.Result.Message</div>
                            @if (!string.IsNullOrEmpty(Model.Result.ErrorDetails))
                            {
                                <div class="small text-muted mt-2">
                                    <strong>Détails:</strong> @Model.Result.ErrorDetails
                                </div>
                            }

                            <div class="mt-3">
                                <a asp-page="Index" class="btn btn-outline-primary py-2 px-4">
                                    <i class="fas fa-redo me-1"></i>
                                    Réessayer
                                </a>
                            </div>
                        </div>
                    </div>
                }
            </div>
        }

    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        // Script pour gérer le drag & drop et l'affichage du fichier
        const fileDropArea = document.getElementById('fileDropArea');
        const fileInput = document.getElementById('pdfFileInput');
        const fileInfoDisplay = document.getElementById('fileInfoDisplay');

        // Empêcher le comportement par défaut
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            fileDropArea.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        // Highlight au survol
        ['dragenter', 'dragover'].forEach(eventName => {
            fileDropArea.addEventListener(eventName, () => {
                fileDropArea.classList.add('dragover');
            }, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            fileDropArea.addEventListener(eventName, () => {
                fileDropArea.classList.remove('dragover');
            }, false);
        });

        // Gestion du drop
        fileDropArea.addEventListener('drop', handleDrop, false);
        fileInput.addEventListener('change', handleFileSelect, false);

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            if (files.length > 0) {
                fileInput.files = files;
                displayFileInfo(files[0]);
            }
        }

        function handleFileSelect(e) {
            const files = e.target.files;
            if (files.length > 0) {
                displayFileInfo(files[0]);
            }
        }

        function displayFileInfo(file) {
            document.getElementById('fileName').textContent = file.name;
            document.getElementById('fileSize').textContent = formatFileSize(file.size);
            fileInfoDisplay.style.display = 'block';
            fileDropArea.classList.add('file-selected');
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function resetFileSelection() {
            fileInput.value = '';
            fileInfoDisplay.style.display = 'none';
            fileDropArea.classList.remove('file-selected');
        }
    </script>
} *@

@page
@model SecureDocumentPdf.Pages.IndexModel
@{
    ViewData["Title"] = "Sécurisation PDF";
}

<div class="row justify-content-center mt-4">
    <div class="col-lg-10">
        <!-- En-tête avec titre et description -->
        <div class="text-center mb-5">
            <h1 class="display-6 text-primary mb-3 fw-bold">
                <i class="fas fa-file-shield me-3"></i>
                Sécurisation PDF Professionnelle
            </h1>
            <p class="lead text-muted fs-5">
                Protégez vos documents PDF avec signature numérique, watermark, horodatage et chiffrement 128-bit
            </p>
        </div>

        <!-- Carte principale de l'application -->
        <div class="card shadow-lg border-0 rounded-4">
            <div class="card-header bg-gradient-primary text-white py-4">
                <h4 class="card-title mb-0 fs-3">
                    <i class="fas fa-upload me-2"></i>
                    Télécharger et Sécuriser votre PDF
                </h4>
            </div>
            <div class="card-body p-5">

                <!-- Formulaire d'upload -->
                <form method="post" enctype="multipart/form-data" id="uploadForm" novalidate>
                    @Html.AntiForgeryToken()

                    <!-- Nom utilisateur -->
                    <div class="mb-4">
                        <label asp-for="UserName" class="form-label fw-bold fs-5">
                            <i class="fas fa-user me-2 text-primary"></i>Nom d'utilisateur
                        </label>
                        <input asp-for="UserName" class="form-control form-control-lg shadow-sm"
                               placeholder="Votre nom ou identifiant" />
                        <span asp-validation-for="UserName" class="text-danger"></span>
                    </div>

                    <!-- Zone de drag & drop GRANDE -->
                    <div class="mb-4">
                        <label asp-for="PdfFile" class="form-label fw-bold fs-5 mb-3">
                            <i class="fas fa-file-pdf me-2 text-primary"></i>Fichier PDF à sécuriser
                        </label>

                        <div class="file-drop-area-large" id="fileDropArea">
                            <div class="file-drop-content">
                                <div class="file-drop-icon-large mb-4">
                                    <i class="fas fa-cloud-upload-alt fa-6x text-primary"></i>
                                </div>
                                <div class="file-drop-text-large">
                                    <h3 class="fw-bold text-dark mb-3">Glissez-déposez votre PDF ici</h3>
                                    <p class="fs-5 text-muted mb-4">ou</p>
                                    <button type="button" class="btn btn-primary btn-lg px-5 py-3 shadow" onclick="document.getElementById('pdfFileInput').click()">
                                        <i class="fas fa-folder-open me-2"></i>
                                        Parcourir les fichiers
                                    </button>
                                </div>
                                <input asp-for="PdfFile" type="file" class="file-input"
                                       id="pdfFileInput" accept=".pdf,application/pdf" style="display: none;" />
                            </div>

                            <!-- Informations fichier sélectionné -->
                            <div class="file-selected-info-large" id="fileInfoDisplay" style="display: none;">
                                <div class="d-flex align-items-center justify-content-between">
                                    <div class="d-flex align-items-center">
                                        <i class="fas fa-file-pdf fa-3x text-danger me-4"></i>
                                        <div>
                                            <h5 class="mb-1 fw-bold" id="fileName">Document.pdf</h5>
                                            <p class="mb-0 text-muted" id="fileSize">0 MB</p>
                                        </div>
                                    </div>
                                    <button type="button" class="btn btn-outline-danger btn-sm" onclick="resetFileSelection()">
                                        <i class="fas fa-times me-1"></i> Supprimer
                                    </button>
                                </div>
                            </div>
                        </div>

                        <span asp-validation-for="PdfFile" class="text-danger"></span>
                        <div class="form-text mt-3">
                            <i class="fas fa-info-circle me-1"></i>
                            Format accepté : <strong>PDF uniquement</strong> • Taille maximale : <strong>50 MB</strong>
                        </div>
                    </div>

                    <!-- Informations sur le traitement -->
                    <div class="alert alert-info border-0 shadow-sm rounded-3 mb-4" role="alert">
                        <h6 class="alert-heading fw-bold fs-5 mb-3">
                            <i class="fas fa-shield-alt me-2"></i>Traitements de sécurité appliqués :
                        </h6>
                        <div class="row g-3">
                            <div class="col-md-4">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-check-circle text-success fs-4 me-2"></i>
                                    <span>Signature PAdES</span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-check-circle text-success fs-4 me-2"></i>
                                    <span>Hash SHA256</span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-check-circle text-success fs-4 me-2"></i>
                                    <span>Horodatage RFC3161</span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-check-circle text-success fs-4 me-2"></i>
                                    <span>Watermark personnalisé</span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-check-circle text-success fs-4 me-2"></i>
                                    <span>Nettoyage métadonnées</span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-lock text-danger fs-4 me-2"></i>
                                    <span><strong>Chiffrement 128-bit</strong></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Bouton de traitement -->
                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary btn-lg py-3 fs-4 shadow-lg" id="submitBtn">
                            <i class="fas fa-shield-alt me-2"></i>
                            Sécuriser mon PDF
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Affichage des résultats après traitement -->
        @if (Model.Result != null)
        {
            <div class="mt-4" id="resultArea">
                @if (Model.Result.Success)
                {
                    <!-- Succès -->
                    <div class="card border-success result-card-enter shadow-lg">
                        <div class="card-header bg-success text-white py-3">
                            <h5 class="card-title mb-0 fs-4">
                                <i class="fas fa-check-circle me-2"></i>
                                PDF Sécurisé avec Succès !
                            </h5>
                        </div>
                        <div class="card-body p-4">
                            <p class="card-text mb-3 fs-5">
                                Votre document PDF a été traité, chiffré et sécurisé. Vous pouvez maintenant télécharger :
                            </p>

                            <!-- NOUVEAU : Affichage des informations de protection -->
                            @if (Model.Result.IsPasswordProtected)
                            {
                                <div class="alert alert-warning mb-4">
                                    <h6 class="alert-heading">
                                        <i class="fas fa-lock me-2"></i>Protection par mot de passe activée
                                    </h6>
                                    <p class="mb-0">@Model.Result.ProtectionInfo</p>
                                    <hr>
                                    <p class="mb-0 small">
                                        <strong>⚠️ Important :</strong> Le mot de passe propriétaire est sauvegardé dans un fichier séparé (PASSWORD_*.json).
                                        Conservez-le précieusement pour pouvoir modifier le PDF ultérieurement.
                                    </p>
                                </div>
                            }

                            <div class="row g-3">
                                <div class="col-md-6">
                                    <a href="@Model.Result.SecuredPdfPath" class="btn btn-outline-success w-100 py-3" download>
                                        <i class="fas fa-download me-2"></i>
                                        Télécharger le PDF sécurisé
                                    </a>
                                </div>
                                <div class="col-md-6">
                                    <a href="@Model.Result.ProofFilePath" class="btn btn-outline-info w-100 py-3" download>
                                        <i class="fas fa-certificate me-2"></i>
                                        Télécharger le fichier de preuve
                                    </a>
                                </div>
                            </div>

                            <!-- Informations détaillées -->
                            <div class="mt-4 p-4 bg-light rounded-3">
                                <h6 class="text-success fw-bold mb-3">
                                    <i class="fas fa-info-circle me-2"></i>Informations du traitement
                                </h6>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <strong>Hash original :</strong><br>
                                        <small class="text-monospace">@Model.Result.OriginalHash</small>
                                    </div>
                                    <div class="col-md-6">
                                        <strong>Hash traité :</strong><br>
                                        <small class="text-monospace">@Model.Result.ProcessedHash</small>
                                    </div>
                                    <div class="col-md-4">
                                        <strong>Traité le :</strong><br>
                                        <small>@Model.Result.ProcessedAt.ToString("dd/MM/yyyy HH:mm:ss")</small>
                                    </div>
                                    <div class="col-md-4">
                                        <strong>Taille :</strong><br>
                                        <small>@Model.Result.FileSizeFormatted</small>
                                    </div>
                                    <div class="col-md-4">
                                        <strong>Durée :</strong><br>
                                        <small>@Model.Result.ProcessingDurationSeconds.ToString("F2")s</small>
                                    </div>
                                    @if (Model.Result.IsPasswordProtected)
                                    {
                                        <div class="col-12">
                                            <div class="alert alert-danger mb-0">
                                                <i class="fas fa-lock me-2"></i>
                                                <strong>Niveau de sécurité : @Model.Result.SecurityLevel</strong>
                                            </div>
                                        </div>
                                    }
                                </div>
                            </div>

                            <!-- Étapes de traitement réalisées -->
                            @if (Model.Result.ProcessingSteps.Any())
                            {
                                <div class="mt-4">
                                    <h6 class="text-success fw-bold mb-3">
                                        <i class="fas fa-tasks me-2"></i>Traitements appliqués :
                                    </h6>
                                    <div class="row g-2">
                                        @foreach (var step in Model.Result.ProcessingSteps)
                                        {
                                            <div class="col-md-6">
                                                <div class="processing-step completed small">
                                                    @step
                                                </div>
                                            </div>
                                        }
                                    </div>
                                </div>
                            }
                        </div>
                    </div>
                }
                else
                {
                    <!-- Erreur -->
                    <div class="card border-danger result-card-enter shadow-lg">
                        <div class="card-header bg-danger text-white py-3">
                            <h5 class="card-title mb-0 fs-4">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                Erreur de Traitement
                            </h5>
                        </div>
                        <div class="card-body p-4">
                            <div class="text-danger fs-5 mb-2">@Model.Result.Message</div>
                            @if (!string.IsNullOrEmpty(Model.Result.ErrorDetails))
                            {
                                <div class="small text-muted mt-2">
                                    <strong>Détails:</strong> @Model.Result.ErrorDetails
                                </div>
                            }

                            <div class="mt-3">
                                <a asp-page="Index" class="btn btn-outline-primary py-2 px-4">
                                    <i class="fas fa-redo me-1"></i>
                                    Réessayer
                                </a>
                            </div>
                        </div>
                    </div>
                }
            </div>
        }

    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        // Script pour gérer le drag & drop
        const fileDropArea = document.getElementById('fileDropArea');
        const fileInput = document.getElementById('pdfFileInput');
        const fileInfoDisplay = document.getElementById('fileInfoDisplay');

        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            fileDropArea.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            fileDropArea.addEventListener(eventName, () => {
                fileDropArea.classList.add('dragover');
            }, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            fileDropArea.addEventListener(eventName, () => {
                fileDropArea.classList.remove('dragover');
            }, false);
        });

        fileDropArea.addEventListener('drop', handleDrop, false);
        fileInput.addEventListener('change', handleFileSelect, false);

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            if (files.length > 0) {
                fileInput.files = files;
                displayFileInfo(files[0]);
            }
        }

        function handleFileSelect(e) {
            const files = e.target.files;
            if (files.length > 0) {
                displayFileInfo(files[0]);
            }
        }

        function displayFileInfo(file) {
            document.getElementById('fileName').textContent = file.name;
            document.getElementById('fileSize').textContent = formatFileSize(file.size);
            fileInfoDisplay.style.display = 'block';
            fileDropArea.classList.add('file-selected');
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function resetFileSelection() {
            fileInput.value = '';
            fileInfoDisplay.style.display = 'none';
            fileDropArea.classList.remove('file-selected');
        }
    </script>
}